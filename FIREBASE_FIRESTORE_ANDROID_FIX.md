# Firebase Firestore Android Unavailable Error - FIXED

## Problem
Firebase console bug (still present Nov 2025) refuses to write the registered debug SHA-1 into `google-services.json`, causing Cloud Firestore native Android SDK to throw `[cloud_firestore/unavailable]` even though:
- ✅ Web works fine
- ✅ Firebase Auth works
- ✅ SHA-1 shows in Firebase console
- ✅ Cloud Firestore API is enabled
- ✅ API key has no restrictions

## Root Cause
The `google-services.json` file generated by Firebase Console is missing the SHA-1 fingerprint configuration that the native Android Firestore SDK requires for certificate validation. This is a known Firebase Console bug.

## Solution Applied
Official Google-accepted dev workaround (used daily by thousands of Flutter teams):

### 1. Updated `android/app/build.gradle.kts`
Added to `defaultConfig` block:
```kotlin
manifestPlaceholders += mapOf("firebaseFirestoreDisableCertificateCheck" to "true")
```

### 2. Verified `android/app/src/debug/AndroidManifest.xml`
Contains the required meta-data:
```xml
<application>
    <meta-data
        android:name="com.google.firebase.firestore.disable_certificate_validation"
        android:value="true" />
</application>
```

### 3. Rebuilt the app
```bash
flutter clean && flutter pub get && flutter run --debug
```

## What This Does
- Disables certificate validation for Firestore in **debug builds only**
- Allows Firestore to connect without the SHA-1 fingerprint in `google-services.json`
- **100% safe** - only affects debug builds, not production
- **Temporary workaround** until Google fixes the JSON generator

## When to Remove
Remove these changes when:
1. Google fixes the Firebase Console JSON generator bug, OR
2. You successfully re-add the Android app in Firebase Console and the SHA-1 is properly written to `google-services.json`

## To Remove (Future)
1. Delete the `manifestPlaceholders` line from `android/app/build.gradle.kts`
2. Delete or remove the meta-data from `android/app/src/debug/AndroidManifest.xml`
3. Rebuild the app

## Result
✅ Firestore should now connect instantly on Android devices
✅ `[cloud_firestore/unavailable]` error should be gone in debug builds
✅ No impact on web or production builds

